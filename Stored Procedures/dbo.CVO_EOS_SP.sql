SET QUOTED_IDENTIFIER ON
GO
SET ANSI_NULLS ON
GO

-- =============================================
-- Author:		ELABARBERA
-- Create date: 5/17/2013
-- Description:	LISTS FOR EOS - END OF SUNS
-- EXEC CVO_EOS_SP
-- 090314 - tag - read sku list from new table cvo_eos_tbl
-- =============================================

CREATE PROCEDURE [dbo].[CVO_EOS_SP]

AS
BEGIN

	SET NOCOUNT ON;

declare @numberOfColumns int
SET @numberOfColumns = 3

IF(OBJECT_ID('tempdb.dbo.#Data') is not null)  
drop table #Data

select * 
INTO #Data 
from 
(
select 'EOS' as Prog, Brand, style, eos.part_no, pom_date, 
case when gender LIKE '%CHILD%' THEN 'Kids' 
	when gender = 'FEMALE-ADULT' THEN 'Womens' 
	else 'Mens' end as Gender, Avail, ReserveQty, 
	Avail as  TrueAvail
 -- tag 090314 - change to table from list of skus
 from cvo_eos_tbl eos 
 left outer join cvo_items_discontinue_vw id (nolock) on eos.part_no = id.part_no
 where isnull(id.type,'SUN') = 'SUN'
 and eos.eff_date < getdate() and isnull(eos.obs_date, getdate()) >= getdate()
 ) s
 order by Prog, gender, brand, style, part_no

 /*
 and part_no in 
 -- LIST SKU'S BELOW
-- LIST for 7/8
('BC804HOR5818', 'BCAMSBLA5715', 'BCAMSBRO5715', 'BCENCBLA5716', 'BCENCBRO5716', 'BCFLIRAS5817', 'BCGLIBLA5617', 'BCGLIBRO5617', 'BCGLSBRO5615', 'BCGLSTEA5615', 'BCJOYBLA5715', 'BCJOYBRO5715', 'BCLUXBLA5814', 'BCLUXTOR5814', 'BCMEYBUR5316', 'BCMEYEGG5316', 'BCSAUBRO5917', 'BCSAUNAV5917', 'BCSSSTOR5616', 'BCSSSWIN5616', 'BCSWAMAH5718', 'BCTICPUR5314', 'BCVAMBLU5413', 'BCVAMRED5413', 'BCVIBRED5616', 'BCWHIBLA5318', 'BCWHIPLU5318', 'CH600PUR5717', 'CH609GRN5717', 'CH609ROS5717', 'CH612NAV5419', 'CH613NAV5221', 'CH613PLU5221', 'CH614TEA5814', 'CH615COB5616', 'CH615CRY5616', 'CH616EGG5816', 'CH616HON5816', 'CH617TOR5716', 'CH619CRY5018', 'CH619TOR5018', 'CH622BLA5019', 'CH622HON5019', 'CH682INK5318', 'CH688BLA5617', 'CH688BRO5617', 'CH688GRN5617', 'CH689BLA5220', 'CH689BRO5220', 'CH690BLA5817', 'CH690KHA5817', 'CH691BLA5519', 'CH691OLI5519', 'CH692BLA4724', 'CH692COR4724', 'CH693COB5620', 'CH693TOR5620', 'CH694BRO5617', 'CH694NAV5617', 'CH696GRN5121', 'CH696HON5121', 'ETBERBLA5914', 'ETBERWIN5914', 'ETBRABLA5915', 'ETBRATOR5915', 'ETKENBRO5617', 'ETKENPLU5617', 'ETLIMEGG5816', 'ETLIMTOR5816', 'ETMALBLA5617', 'ETMALCHO5617', 'ETMOJAMB5417', 'ETMOJBLA5417', 'ETMOJBRO5417', 'ETMUNANT5816', 'ETMUNBLA5816', 'ETPAAEGG5816', 'ETRIOWIN5816', 'ETSARBER5617', 'ETSARBLA5617', 'IZ750BLA6217', 'IZ754BLA6015', 'IZ754CHR6015', 'IZ756KHA5019', 'IZ756PEW5019', 'IZ757BLA5617', 'IZ757TOR5617', 'IZ758FOR6013', 'IZ758NAV6013', 'IZX89BRO6017', 'JM550BLA5417', 'JM550RED5417', 'JM552AUB5717', 'JM552BRO5717', 'JM554BLA5715', 'JM554BRO5715', 'JM557BLA5815', 'JM557BUR5815', 'JM558BLU5917', 'JM558BUR5917', 'JM559BRO5717', 'JM559RED5717', 'JM560BLA5815', 'JM560BRO5815', 'JM562BLA5616', 'JM562BRO5616', 'MEDELBLU5717', 'MEDELBRO5717', 'MEDELOLI5717', 'MEDISBLA5715', 'MEDISBRO5715', 'MEDISGRN5715', 'MEGHOBLA5323', 'MEGHOBLU5323', 'MEGHOMER5323', 'MEGHOTOR5323', 'MEHOOBLA5816', 'MEHOOGRN5816', 'MEHOOSMO5816', 'MEHOUBLA6214', 'MEHOUPEW6214', 'MEMILBLA5814', 'MEMILGOL5814', 'MEMILGUN5814', 'MEPOPBLA6113', 'MEPOPBLU6113', 'MEPOPBRO6113', 'MEPRIBLU5719', 'MEPRIMER5719', 'MEPRISMO5719', 'MEREBBLA5817', 'MEREBBRZ5817', 'MEREBPEW5817', 'MEROUBLA5916', 'MEROUBRO5916', 'MEROUPEW5916', 'MESCOBLA5814', 'MESCOBRO5814', 'MESCOPEW5814', 'MEVAGBLA5914', 'MEVAGGRN5914', 'MEVAGMER5914')

 -- LIST for 6/17
--('BCAMSBLA5715', 'BCAMSBRO5715', 'BCBLIBLA5716', 'BCDRAPLU5719', 'BCGLIBLA5617', 'BCGLIBRO5617', 'BCGLSBRO5615', 'BCGLSTEA5615', 'BCJOYBRO5715', 'BCLUXBLA5814', 'BCLUXTOR5814', 'BCMEYBUR5316', 'BCMEYEGG5316', 'BCPOSBRO5416', 'BCPOSBUR5416', 'BCSAUBRO5917', 'BCSAUNAV5917', 'BCSSSWIN5616', 'BCSWABLA5718', 'BCTICPUR5314', 'BCVAMBLU5413', 'BCVAMRED5413', 'BCVIBBRO5616', 'BCVIBRED5616', 'BCWHIBLA5318', 'BCWHIPLU5318', 'CH600PUR5717', 'CH604BLA5115', 'CH604BLA5515', 'CH604BRO5115', 'CH609GRN5717', 'CH609ROS5717', 'CH612BUR5419', 'CH612NAV5419', 'CH612TOR5419', 'CH613NAV5221', 'CH613PLU5221', 'CH614BRO5814', 'CH614TEA5814', 'CH615COB5616', 'CH615CRY5616', 'CH616EGG5816', 'CH616HON5816', 'CH617TOR5716', 'CH619CRY5018', 'CH619TOR5018', 'CH652BLA5919', 'CH685BRO5813', 'CH688GRN5617', 'CH689BLA5220', 'CH689BRO5220', 'CH690KHA5817', 'CH691BLA5519', 'CH691OLI5519', 'CH692BLA4724', 'CH692COR4724', 'CH693COB5620', 'CH693TOR5620', 'CH694NAV5617', 'ETBERBLA5914', 'ETBERWIN5914', 'ETBRABLA5915', 'ETBRATOR5915', 'ETGENBEI5616', 'ETKENBRO5617', 'ETKENPLU5617', 'ETLIMEGG5816', 'ETLIMTOR5816', 'ETMALCHO5617', 'ETMOJAMB5417', 'ETMOJBLA5417', 'ETMOJBRO5417', 'ETMUNANT5816', 'ETMUNBLA5816', 'ETPAAEGG5816', 'ETSARBER5617', 'ETSARBLA5617', 'IZ756KHA5019', 'IZ756PEW5019', 'IZ757BLA5617', 'IZ757TOR5617', 'IZ758FOR6013', 'IZ758NAV6013', 'IZX88BLA5819', 'IZX89BRO6017', 'JM550BLA5417', 'JM550BRO5417', 'JM550RED5417', 'JM552AUB5717', 'JM552BRO5717', 'JM553PLU5917', 'JM554BLA5715', 'JM554BRO5715', 'JM555BLA6015', 'JM555BRO6015', 'JM556EGG5615', 'JM557BLA5815', 'JM557BUR5815', 'JM558BLU5917', 'JM558BUR5917', 'JM559BRO5717', 'JM559RED5717', 'JM560BLA5815', 'JM560BRO5815', 'JM562BLA5616', 'JM562BRO5616', 'MEDELBLU5717', 'MEDELBRO5717', 'MEDELOLI5717', 'MEDISBLA5715', 'MEDISBRO5715', 'MEDISGRN5715', 'MEGHOBLA5323', 'MEGHOBLU5323', 'MEGHOMER5323', 'MEGHOTOR5323', 'MEHOOBLA5816', 'MEHOOGRN5816', 'MEHOOSMO5816', 'MEMILBLA5814', 'MEMILGOL5814', 'MEMILGUN5814', 'MEPOPBLA6113', 'MEPOPBLU6113', 'MEPOPBRO6113', 'MEPRIBLU5719', 'MEPRIMER5719', 'MEPRISMO5719', 'MEREBBLA5817', 'MEREBBRZ5817', 'MEREBPEW5817', 'MEROUBLA5916', 'MEROUBRO5916', 'MEROUPEW5916', 'MESCOBLA5814', 'MESCOBRO5814', 'MESCOPEW5814', 'MEVAGBLA5914', 'MEVAGGRN5914', 'MEVAGMER5914')
  -- LIST FROM 6/1
  --('BCAMSBLA5715', 'BCAMSBRO5715', 'BCANABLA5716', 'BCANATOR5716', 'BCANATOR6118', 'BCATAGOL5914', 'BCATAGUN5914', 'BCCHRBRO6214', 'BCDAZBLA5616', 'BCDAZPLU5616', 'BCDRABLA5719', 'BCDRAPLU5719', 'BCFLIBRO5817', 'BCFLIRAS5817', 'BCGLAEGG6010', 'BCGLIBLA5617', 'BCGLIBRO5617', 'BCGLSBRO5615', 'BCGLSTEA5615', 'BCJOYBRO5715', 'BCLUXBLA5814', 'BCLUXTOR5814', 'BCMEYBUR5316', 'BCMEYEGG5316', 'BCRITGOL5914', 'BCRITGUN5914', 'BCSAUBRO5917', 'BCSAUNAV5917', 'BCSSSTOR5616', 'BCSSSWIN5616', 'BCTICPUR5314', 'BCVAMBLU5413', 'BCVAMRED5413', 'BCVIBBRO5616', 'BCVIBRED5616', 'BCWHIBLA5318', 'BCWHIPLU5318', 'CH600PUR5717', 'CH609GRN5717', 'CH609ROS5717', 'CH612BUR5419', 'CH612NAV5419', 'CH613NAV5221', 'CH613PLU5221', 'CH614BRO5814', 'CH614TEA5814', 'CH615COB5616', 'CH615CRY5616', 'CH616EGG5816', 'CH616HON5816', 'CH617TOR5716', 'CH619CRY5018', 'CH619TOR5018', 'CH622BLA5019', 'CH622HON5019', 'CH665CHE6014', 'CH670RHO6015', 'CH682BRO5318', 'CH683PEW5817', 'CH688GRN5617', 'CH689BLA5220', 'CH689BRO5220', 'CH690KHA5817', 'CH691BLA5519', 'CH691OLI5519', 'CH692BLA4724', 'CH692COR4724', 'CH693COB5620', 'CH693TOR5620', 'CH694NAV5617', 'ETBERBLA5914', 'ETBERWIN5914', 'ETBRABLA5915', 'ETBRATOR5915', 'ETGENBLA5616', 'ETIOLRUT5814', 'ETKENBRO5617', 'ETKENPLU5617', 'ETLIMEGG5816', 'ETLIMTOR5816', 'ETMALCHO5617', 'ETMOJAMB5417', 'ETMOJBLA5417', 'ETMOJBRO5417', 'ETMUNANT5816', 'ETMUNBLA5816', 'ETPAAEGG5816', 'ETRIOWIN5816', 'ETSARBER5617', 'ETSARBLA5617', 'IZ750BLA5816', 'IZ753BRO6019', 'IZ754BLA6015', 'IZ756KHA5019', 'IZ756PEW5019', 'IZ757BLA5617', 'IZ757TOR5617', 'IZ758FOR6013', 'IZ758NAV6013', 'IZX87BLA5717', 'IZX88BLA5819', 'IZX89BLA6017', 'IZX89BRO6017', 'JM550BLA5417', 'JM550BRO5417', 'JM550RED5417', 'JM552AUB5717', 'JM552BRO5717', 'JM553PLU5917', 'JM554BLA5715', 'JM554BRO5715', 'JM555BLA6015', 'JM555BRO6015', 'JM556EGG5615', 'JM557BLA5815', 'JM557BUR5815', 'JM558BLU5917', 'JM558BUR5917', 'JM559BRO5717', 'JM559RED5717', 'JM560BLA5815', 'JM560BRO5815', 'JM562BLA5616', 'JM562BRO5616', 'MEDELBLU5717', 'MEDELBRO5717', 'MEDELOLI5717', 'MEDISBLA5715', 'MEDISBRO5715', 'MEDISGRN5715', 'MEGHOBLA5323', 'MEGHOBLU5323', 'MEGHOMER5323', 'MEGHOTOR5323', 'MEHOOBLA5816', 'MEHOOGRN5816', 'MEHOOSMO5816', 'MEMILBLA5814', 'MEMILGOL5814', 'MEMILGUN5814', 'MEPOPBLA6113', 'MEPOPBLU6113', 'MEPOPBRO6113', 'MEPRIBLU5719', 'MEPRIMER5719', 'MEPRISMO5719', 'MEREBBLA5817', 'MEREBBRZ5817', 'MEREBPEW5817', 'MEROUBLA5916', 'MEROUBRO5916', 'MEROUPEW5916', 'MESCOBLA5814', 'MESCOBRO5814', 'MESCOPEW5814', 'MEVAGBLA5914', 'MEVAGGRN5914', 'MEVAGMER5914')
 
-- List from 5/8
--('BC804HOR5818', 'BC813BRO5816', 'BCAMSBLA5715', 'BCAMSBRO5715', 'BCANABLA6118', 'BCDAZPLU5616', 'BCENCBLA5716', 'BCESSBLA5715', 'BCESSJAV5715', 'BCGLIBLA5617', 'BCGLIBRO5617', 'BCGLWKHA5715', 'BCIDOHOR5818', 'BCJOYBLA5715', 'BCJOYBRO5715', 'BCJUBRUT5715', 'BCLIVBLU5715', 'BCLUXTOR5814', 'BCMEYBUR5316', 'BCMEYEGG5316', 'BCPOSBUR5416', 'BCSAUBRO5917', 'BCSAUNAV5917', 'BCSSSTOR5616', 'BCSSSWIN5616', 'BCTICPUR5314', 'BCTRIBRO5618', 'BCTRIPEW5618', 'BCVAMBLU5413', 'BCVAMRED5413', 'CH600PUR5717', 'CH605BLA5915', 'CH609GRN5717', 'CH609ROS5717', 'CH612BUR5419', 'CH612NAV5419', 'CH613NAV5221', 'CH613PLU5221', 'CH614TEA5814', 'CH615COB5616', 'CH615CRY5616', 'CH616EGG5816', 'CH616HON5816', 'CH617TOR5716', 'CH619CRY5018', 'CH619TOR5018', 'CH622BLA5019', 'CH622HON5019', 'CH686PEW6017', 'CH688BRO5617', 'CH688GRN5617', 'CH689BLA5220', 'CH689BRO5220', 'CH690KHA5817', 'CH691BLA5519', 'CH691OLI5519', 'CH692BLA4724', 'CH692COR4724', 'CH693COB5620', 'CH693TOR5620', 'CH694NAV5617', 'CH696GRN5121', 'CH696HON5121', 'ETBERBLA5914', 'ETBERWIN5914', 'ETBRABLA5915', 'ETBRATOR5915', 'ETIOLBRZ5814', 'ETIOLRUT5814', 'ETKENBRO5617', 'ETKENPLU5617', 'ETLIMEGG5816', 'ETLIMTOR5816', 'ETMALCHO5617', 'ETMOJAMB5417', 'ETMOJBLA5417', 'ETMOJBRO5417', 'ETMUNANT5816', 'ETMUNBLA5816', 'ETPAAEGG5816', 'ETSARBER5617', 'ETSARBLA5617', 'IZ750BLA6217', 'IZ753BRO6019', 'IZ755BLA5715', 'IZ756KHA5019', 'IZ756PEW5019', 'IZ757BLA5617', 'IZ757TOR5617', 'IZ758FOR6013', 'IZ758NAV6013', 'IZX88BLA5819', 'IZX89BRO6017', 'JM550BLA5417', 'JM550BRO5417', 'JM550RED5417', 'JM552AUB5717', 'JM552BRO5717', 'JM553PLU5917', 'JM554BLA5715', 'JM554BRO5715', 'JM555BLA6015', 'JM555BRO6015', 'JM556EGG5615', 'JM557BLA5815', 'JM557BUR5815', 'JM558BLU5917', 'JM558BUR5917', 'JM559BRO5717', 'JM559RED5717', 'JM560BLA5815', 'JM560BRO5815', 'JM562BLA5616', 'JM562BRO5616', 'MEDELBLU5717', 'MEDELBRO5717', 'MEDELOLI5717', 'MEDISBLA5715', 'MEDISBRO5715', 'MEDISGRN5715', 'MEGHOBLA5323', 'MEGHOBLU5323', 'MEGHOMER5323', 'MEGHOTOR5323', 'MEHOOBLA5816', 'MEHOOGRN5816', 'MEHOOSMO5816', 'MEMILBLA5814', 'MEPOPBLA6113', 'MEPOPBLU6113', 'MEPOPBRO6113', 'MEPRIBLU5719', 'MEPRIMER5719', 'MEPRISMO5719', 'MEREBBLA5817', 'MEREBBRZ5817', 'MEREBPEW5817', 'MEROUBLA5916', 'MEROUBRO5916', 'MEROUPEW5916', 'MESCOBLA5814', 'MESCOBRO5814', 'MESCOPEW5814', 'MEVAGBLA5914', 'MEVAGGRN5914', 'MEVAGMER5914')
-- List from 4/10 
--('BC804HOR5818', 'BC813BRO5816', 'BCAPORUT5914', 'BCDAZBLA5616', 'BCDAZPLU5616', 'BCENCBRO5716', 'BCGLWKHA5715', 'BCJOYBLA5715', 'BCJOYBRO5715', 'BCLUXTOR5814', 'BCMEYEGG5316', 'BCPOSBUR5416', 'BCRITGUN5914', 'BCSAVRED6017', 'BCSILBRO5917', 'BCSILGRE5917', 'BCSILROS5917', 'BCSSSTOR5616', 'BCSSSWIN5616', 'BCSWAMAH5718', 'BCTICPUR5314', 'CH600PUR5717', 'CH609GRN5717', 'CH609ROS5717', 'CH612BUR5419', 'CH612NAV5419', 'CH613NAV5221', 'CH613PLU5221', 'CH614TEA5814', 'CH615COB5616', 'CH615CRY5616', 'CH616EGG5816', 'CH616HON5816', 'CH617TOR5716', 'CH650GOL6114', 'CH686BLA6017', 'CH686PEW6017', 'CH688BLA5617', 'CH688BRO5617', 'CH689BLA5220', 'CH689BRO5220', 'CH690KHA5817', 'CH691OLI5519', 'CH692BLA4724', 'CH692COR4724', 'CH693COB5620', 'CH694BRO5617', 'CH694NAV5617', 'ETIOLBRZ5814', 'ETIOLRUT5814', 'ETKENBRO5617', 'ETLIMTOR5816', 'ETMALBLA5617', 'ETMOJAMB5417', 'ETMOJBLA5417', 'ETMOJBRO5417', 'ETMUNANT5816', 'ETMUNBLA5816', 'ETSAGBUR5917', 'IZ750BLA6217', 'IZ753BRO6019', 'IZ754BLA6015', 'IZ754CHR6015', 'IZ755BLA5715', 'IZ756KHA5019', 'IZ756PEW5019', 'IZ757BLA5617', 'IZ757TOR5617', 'IZ758FOR6013', 'IZ758NAV6013', 'IZX88BLA5819', 'IZX88GRA5819', 'IZX89BRO6017', 'JM549BUR5717', 'JM550BLA5417', 'JM550BRO5417', 'JM550RED5417', 'JM552AUB5717', 'JM552BRO5717', 'JM553PLU5917', 'JM554BLA5715', 'JM554BRO5715', 'JM555BLA6015', 'JM555BRO6015', 'JM556BRO5615', 'JM556EGG5615', 'JM557BLA5815', 'JM557BUR5815', 'JM558BLU5917', 'JM558BUR5917', 'JM559BRO5717', 'JM559RED5717', 'JM560BLA5815', 'JM560BRO5815', 'JM562BLA5616', 'JM562BRO5616', 'MEDELBLU5717', 'MEDELBRO5717', 'MEDELOLI5717', 'MEDISBLA5715', 'MEDISBRO5715', 'MEDISGRN5715', 'MEGHOBLA5323', 'MEGHOBLU5323', 'MEGHOMER5323', 'MEGHOTOR5323', 'MEHOOBLA5816', 'MEHOOGRN5816', 'MEHOOSMO5816', 'MEPOPBLA6113', 'MEPOPBLU6113', 'MEPOPBRO6113', 'MEPRIBLU5719', 'MEPRIMER5719', 'MEPRISMO5719', 'MEREBBLA5817', 'MEREBBRZ5817', 'MEREBPEW5817', 'MEROUBLA5916', 'MEROUBRO5916', 'MEROUPEW5916', 'MESCOBLA5814', 'MESCOBRO5814', 'MESCOPEW5814', 'MEVAGBLA5914', 'MEVAGGRN5914', 'MEVAGMER5914', 'MEXRAGRN5816')
-- List from 3/13  
--('BCAREGOL6016', 'BCBEAPEW5914', 'BCBLIRED5716', 'BCCERPIN5718', 'BCDRABLA5719', 'BCDRAPLU5719', 'BCENCBLA5716', 'BCENCBRO5716', 'BCFLIBRO5817', 'BCFLIRAS5817', 'BCGLABLA6010', 'BCGLAEGG6010', 'BCGLWBLA5715', 'BCGLWKHA5715', 'BCIDOHOR5818', 'BCJUBRUT5715', 'BCLIVBLU5715', 'BCLIVCAR5715', 'BCPOIEGG5718', 'BCPOSBRO5416', 'BCPOSBUR5416', 'BCRITGOL5914', 'BCRITGUN5914', 'BCSILGRE5917', 'BCSSSTOR5616', 'BCSWABLA5718', 'BCSWAMAH5718', 'CH612BUR5419', 'CH650GOL6114', 'CH651HON5816', 'CH652BLA5919', 'CH658TOR5915', 'CH660RHO13516', 'CH662TOR6014', 'CH680BLA6416', 'CH680TOR6416', 'CH682INK5318', 'CH685PEW5813', 'CH687GUN5818', 'CH688BLA5617', 'CH688BRO5617', 'CH691OLI5519', 'CH692BLA4724', 'CH693COB5620', 'ETGENBEI5616', 'ETGENBLA5616', 'ETIOLBRZ5814', 'ETIOLRUT5814', 'ETMALBLA5617', 'ETRIOBLA5816', 'ETRIOWIN5816', 'IZ746GRA6015', 'IZ750BLA5816', 'IZ750BLA6217', 'IZ753BRO6019', 'IZ753GUN6019', 'IZ754BLA6015', 'IZ754CHR6015', 'IZ755BLA5715', 'IZ756KHA5019', 'IZ756PEW5019', 'IZ757BLA5617', 'IZ757TOR5617', 'IZ758FOR6013', 'IZ758NAV6013', 'IZX89BRO6017', 'JM547TOR5915', 'JM549BUR5717', 'JM550BLA5717', 'JM550BRO5417', 'JM555BRO6015', 'JM556BRO5615', 'JM558BUR5917', 'JM560BLA5815', 'JM562BLA5616', 'MEHOUPEW6214', 'MEPOPBLU6113', 'MESCOBLA5814', 'MESCOBRO5814', 'MESCOPEW5814', 'MEXRABLA5816', 'MEXRAGRN5816')
-- Old List from 2/13
--('BCBLIBLA5716', 'BCCERPIN5718', 'BCDAZPLU5616', 'BCDRABLA5719', 'BCDRAPLU5719', 'BCDREWIN5716', 'BCENCBLA5716', 'BCENCBRO5716', 'BCFLIBRO5817', 'BCFLIRAS5817', 'BCGLAEGG6010', 'BCGLSTEA5615', 'BCGLWKHA5715', 'BCIDOHOR5818', 'BCJOYBLA5715', 'BCJOYBRO5715', 'BCLIVBLU5715', 'BCLIVCAR5715', 'BCLUXBLA5814', 'BCLUXTOR5814', 'BCMEYBUR5316', 'BCMEYEGG5316', 'BCPOIBRO5718', 'BCPOIEGG5718', 'BCPOSBRO5416', 'BCPOSBUR5416', 'BCRITGOL5914', 'BCRITGUN5914', 'BCSSSTOR5616', 'BCSSSWIN5616', 'BCSWABLA5718', 'BCSWAMAH5718', 'BCVIBBRO5616', 'BCVIBRED5616', 'BCWHIBLA5318', 'BCWHIPLU5318', 'CH600PUR5717', 'CH602OLI5615', 'CH604BLA5115', 'CH604BRO5115', 'CH604BRO5515', 'CH608BLA5715', 'CH608WIN5715', 'CH609GRN5717', 'CH609ROS5717', 'CH610GOL5715', 'CH610GUN5715', 'CH611BRO5716', 'CH611WIN5716', 'CH612BUR5419', 'CH612NAV5419', 'CH613NAV5221', 'CH613PLU5221', 'CH615COB5616', 'CH615CRY5616', 'CH616EGG5816', 'CH616HON5816', 'CH617TOR5716', 'CH650GOL6114', 'CH652BLA5919', 'CH662TOR6014', 'CH682BRO5318', 'CH683BRO5817', 'CH683PEW5817', 'CH684BRO5617', 'CH685BRO5813', 'CH686BLA6017', 'CH686PEW6017', 'CH687BLA5818', 'CH687GUN5818', 'CH688BLA5617', 'CH688BRO5617', 'CH689BLA5220', 'CH689BRO5220', 'CH690BLA5817', 'CH690KHA5817', 'CH691OLI5519', 'CH692BLA4724', 'CH692COR4724', 'CH693COB5620', 'CH694BRO5617', 'CH694NAV5617', 'ETBERBLA5914', 'ETBERWIN5914', 'ETBRABLA5915', 'ETBRATOR5915', 'ETGENBEI5616', 'ETGENBLA5616', 'ETIOLBRZ5814', 'ETKENBRO5617', 'ETKENPLU5617', 'ETLIMEGG5816', 'ETLIMTOR5816', 'ETMALBLA5617', 'ETMALCHO5617', 'ETMOJAMB5417', 'ETMOJBLA5417', 'ETMOJBRO5417', 'ETMUNANT5816', 'ETMUNBLA5816', 'ETSARBER5617', 'ETSARBLA5617', 'IZ750BLA5816', 'IZ750BLA6217', 'IZ753BRO6019', 'IZ753GUN6019', 'IZ755BLA5715', 'IZ756KHA5019', 'IZ756PEW5019', 'IZ757BLA5617', 'IZ757TOR5617', 'IZ758FOR6013', 'IZ758NAV6013', 'IZX88BLA5819', 'IZX88GRA5819', 'IZX89BLA6017', 'IZX89BRO6017', 'JM549BUR5717', 'JM550BLA5417', 'JM550BLA5717', 'JM550BRO5417', 'JM550BRO5717', 'JM550RED5417', 'JM552AUB5717', 'JM552BRO5717', 'JM553PLU5917', 'JM554BLA5715', 'JM554BRO5715', 'JM555BLA6015', 'JM555BRO6015', 'JM556EGG5615', 'JM557BLA5815', 'JM557BUR5815', 'JM558BLU5917', 'JM558BUR5917', 'JM559BRO5717', 'JM559RED5717', 'JM560BLA5815', 'JM560BRO5815', 'JM562BLA5616', 'JM562BRO5616', 'MEDELBLU5717', 'MEDELBRO5717', 'MEDELOLI5717', 'MEDISBLA5715', 'MEDISBRO5715', 'MEDISGRN5715', 'MEGHOBLA5323', 'MEGHOBLU5323', 'MEGHOMER5323', 'MEGHOTOR5323', 'MEHOOBLA5816', 'MEHOOGRN5816', 'MEHOOSMO5816', 'MEHOUPEW6214', 'MEPOPBLA6113', 'MEPOPBLU6113', 'MEPOPBRO6113', 'MEPRIBLU5719', 'MEPRIMER5719', 'MEPRISMO5719', 'MEREBBLA5817', 'MEREBBRZ5817', 'MEREBPEW5817', 'MEROUBLA5916', 'MEROUBRO5916', 'MEROUPEW5916', 'MESCOBLA5814', 'MESCOBRO5814', 'MESCOPEW5814', 'MEVAGBLA5914', 'MEVAGGRN5914', 'MEVAGMER5914', 'MEXRABLA5816', 'MEXRAGRN5816')
 -- OLD from January 
--  ('BCAREGOL6016', 'BCATAGOL5914', 'BCATLBLA6015', 'BCBEABLA6316', 'BCBLIBLA5716', 'BCBLIRED5716', 'BCCHABRO5916', 'BCCHATOR5916', 'BCDRABLA5719', 'BCDRAPLU5719', 'BCENCBLA5716', 'BCENCBRO5716', 'BCESSBLA5715', 'BCFLIBRO5817', 'BCFLIRAS5817', 'BCGLABLA6010', 'BCGLAEGG6010', 'BCGLWKHA5715', 'BCIDOCAR5818', 'BCIDOHOR5818', 'BCJUBRUT5715', 'BCLIVBLU5715', 'BCLIVCAR5715', 'BCLYNBLA6012', 'BCLYNHOR6012', 'BCPOIBRO5718', 'BCPOIEGG5718', 'BCPOSBRO5416', 'BCPOSBUR5416', 'BCREATOR5915', 'BCRITGOL5914', 'BCRITGUN5914', 'BCRUNGOL3615', 'BCSILBRO5917', 'BCSILGRE5917', 'BCSILROS5517', 'BCSILROS5917', 'BCSPRBRO5718', 'BCSWABLA5718', 'BCSWAMAH5718', 'BCTRIPEW5618', 'CH600PUR5717', 'CH602OLI5615', 'CH603BLA5715', 'CH604BLA5115', 'CH604BRO5115', 'CH604BRO5515', 'CH606BLA5815', 'CH606TOR5815', 'CH608BLA5715', 'CH608WIN5715', 'CH609GRN5717', 'CH609ROS5717', 'CH611BRO5716', 'CH611WIN5716', 'CH613NAV5221', 'CH613PLU5221', 'CH650GOL6114', 'CH651HON5816', 'CH652BLA5919', 'CH655BLA5715', 'CH658TOR5915', 'CH659TAN5513', 'CH659TOR5513', 'CH660RHO13516', 'CH661BLA5914', 'CH661TOR5914', 'CH662BLA6014', 'CH662TOR6014', 'CH664TOR5817', 'CH665CHE6014', 'CH670GUN6115', 'CH670RHO6015', 'CH671BRO6310', 'CH678INK6015', 'CH679BRO6213', 'CH679GUN6213', 'CH680BLA6416', 'CH680TOR6416', 'CH682BRO5318', 'CH683BRO5817', 'CH683PEW5817', 'CH684BRO5617', 'CH685BRO5813', 'CH686BLA6017', 'CH686PEW6017', 'CH687BLA5818', 'CH687GUN5818', 'CH689BLA5220', 'CH689BRO5220', 'ETANDSAN6115', 'ETCAPAUB6116', 'ETGENBEI5616', 'ETGENBLA5616', 'ETHYDBRO5516', 'ETIOLBRZ5814', 'ETIOLRUT5814', 'ETMALBLA5617', 'ETMALCHO5617', 'ETRIOWIN5816', 'ETSTRBLA6315', 'ETVEGBLA5817', 'ETVEOBLA5716', 'ETVESBUR5717', 'IZ746GRA6015', 'IZ746TOR6015', 'IZ747PEW5818', 'IZ749BRO6517', 'IZ750BLA5816', 'IZ750BLA6217', 'IZ753BRO6019', 'IZ753GUN6019', 'IZ758FOR6013', 'IZ758NAV6013', 'IZX83BRO6019', 'IZX86BRO5917', 'IZX87GRA5717', 'IZX89BLA6017', 'IZX89BRO6017', 'JM540BLA5617', 'JM540BRO5617', 'JM542BUR5915', 'JM547BLA5915', 'JM547TOR5915', 'JM548BRO5818', 'JM549BLA5717', 'JM549BUR5717', 'JM550BLA5717', 'JM552AUB5717', 'JM552BRO5717', 'JM553PLU5917', 'JM554BLA5715', 'JM554BRO5715', 'JM556BRO5615', 'JM556EGG5615', 'JM557BLA5815', 'JM557BUR5815', 'JM558BLU5917', 'JM558BUR5917', 'MEGHOMER5323', 'MEHOUPEW6214', 'MEPOPBLA6113', 'MEPOPBLU6113', 'MEPOPBRO6113', 'MEPRIBLU5719', 'MEPRIMER5719', 'MEPRISMO5719', 'MEXRABLA5816', 'MEXRAGRN5816', 'MEXRYGUN5815')
 -- OLD LIST 
-- ('BCANABLA5716', 'BCANATOR5716', 'BCANATOR6118', 'BCAREGOL6016', 'BCATAGUN5914', 'BCBEABLA6316', 'BCBEAPEW6316', 'BCBLIBLA5716', 'BCCERPIN5718', 'BCDRABLA5719', 'BCDRAPLU5719','BCEGOBRO6018', 'BCEGOGUN6018', 'BCENCBLA5716', 'BCESSBLA5715', 'BCESSBRO5715', 'BCGLABLA6010', 'BCGLAEGG6010', 'BCGLWBLA5715', 'BCIDOCAR5818', 'BCIDOHOR5818', 'BCJUBGOL5715', 'BCJUBRUT5715', 'BCLIVBLU5715', 'BCLIVCAR5715', 'BCLYNBLA6012', 'BCPASBRO5817', 'BCPOIBRO5718', 'BCPOIEGG5718', 'BCPOSBRO5416', 'BCREATOR5915', 'BCSILROS5917', 'BCSPRBRO5718', 'BCTRIPEW5618', 'CH602BLA5615', 'CH602OLI5615', 'CH603BLA5715', 'CH604BLA5515', 'CH604BUR5515', 'CH605BRO5915', 'CH606BLA5815', 'CH606TOR5815', 'CH608BLA5715', 'CH611BRO5716', 'CH611WIN5716', 'CH613NAV5221', 'CH613PLU5221', 'CH650GOL6114', 'CH651HON5816', 'CH652BLA5919', 'CH658TOR5915', 'CH659TOR5513', 'CH660RHO13516', 'CH662TOR6014', 'CH664TOR5817', 'CH665CHE6014', 'CH665TOR6014', 'CH679BRO6213', 'CH679GUN6213', 'CH680BLA6416', 'CH680TOR6416', 'CH682INK5318', 'CH683PEW5817', 'CH684BRO5617', 'CH685BRO5813', 'CH687BLA5818', 'CH689BLA5220', 'CH689BRO5220', 'ETCAPAUB6116', 'ETIOLBRZ5814', 'ETIOLRUT5814', 'ETMALBLA5617', 'ETMALCHO5617', 'ETVEGBLA5817', 'IZ749BRO6517', 'IZ753GUN6019', 'IZ758FOR6013', 'IZ758NAV6013', 'IZX87BLA5717', 'IZX87GRA5717', 'JM547BLA5915', 'JM547TOR5915', 'JM549BUR5717', 'JM553BLA5917', 'JM553PLU5917', 'MEHOUPEW6214', 'MEPOPBLU6113', 'MESCOPEW5814', 'MEXRABLA5816', 'MEXRYGUN5815')
 )tmp


-- select * from #Data where TrueAvail=0
 */ 

IF(OBJECT_ID('tempdb.dbo.#Num') is not null)  drop table #Num
SELECT DISTINCT PROG, GENDER, BRAND, STYLE, 
row_number() over(order by Prog, Gender, brand, style) AS Num 
INTO #Num 
FROM #DATA 
group by PROG, GENDER, BRAND, STYLE 
ORDER BY PROG, GENDER, BRAND, STYLE

-- select * from #data
-- select * from #Num

--select CASE WHEN Num%2=0 THEN 0 ELSE 1 END as Col, * from #Data t1 join #num t2 on t1.prog=t2.prog and t1.brand=t2.brand and t1.style=t2.style
select ((Num+ @numberOfColumns - 1) % @numberOfColumns + 1) as Col, 
t1.Prog, t1.Brand, t1.Style, t1.part_no, t1.pom_date, 
 t1.Gender,
 t1.Avail, t1.ReserveQty, 
 t1.TrueAvail as TrueAvail_2,
 CASE WHEN t1.TrueAvail > 100 THEN '100+' ELSE convert(varchar(20),convert(int,t1.TrueAvail)) END 
 AS TrueAvail
 from #Data t1 
 join #num t2 on t1.prog=t2.prog and t1.gender=t2.gender and t1.brand=t2.brand and t1.style=t2.style order by Prog, Gender, Brand, Style

END
GO
